@using Newtonsoft.Json
@*
    You must be a logged in agent to access this page.
*@

@{
	ViewData["Title"] = "Project 4 - Edit Home Listing";
	Rooms currentRooms = null;
	Images currentImages = null;
	TemperatureControl currentTemperatureControl = null;
	Amenities currentAmenities = null;
	Utilities currentUtilities = null;
	if (ViewBag.EditRooms != null)
	{
		currentRooms = ViewBag.EditRooms;
		currentImages = ViewBag.EditImages;
		currentTemperatureControl = ViewBag.EditTemperature;
		currentAmenities = ViewBag.EditAmenities;
		currentUtilities = ViewBag.EditUtilities;
	}

	int roomCount = 0;

}
<!DOCTYPE html>
<html>
<head>
	<title>Create Home Listing</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
</head>
<body>
	<form asp-controller="RealEstateHome" asp-action="TryFinalizeEditHome" method="POST">
		<h1>Create a Home Listing</h1>

		<div>
			<h2>Home Address</h2>
			<span>Street</span>
			<input name="txtHomeStreet" type="text" placeholder="Enter Street" value="@TempData["txtHomeStreet"]">
			<span>City</span>
			<input name="txtHomeCity" type="text" placeholder="Enter City" value="@TempData["txtHomeCity"]">
			<span>State</span>
			<select name="ddlHomeState" type="text">
				@foreach (States state in Enum.GetValues(typeof(States)))
				{
					if (TempData["ddlHomeState"] != null && TempData["ddlHomeState"].ToString() == state.ToString())
					{
						<option value="@state" selected="selected">@state</option>
					}
					else
					{
						<option value="@state">@state</option>
					}
				}
			</select>
			<span>Zip Code</span>
			<input name="txtHomeZipCode" type="text" placeholder="Enter Zip Code" value="@TempData["txtHomeZipCode"]">

		</div>

		<div>
			<h2>Home Information</h2>
			<span>Asking Price</span>
			<input name="txtHomeCost" type="text" placeholder="Enter Asking Price" value="@TempData["txtHomeCost"]">
			<span id="lblPropertyType">Property Type</span>
			<select name="ddlPropertyType">
				@foreach (PropertyType propertyType in Enum.GetValues(typeof(PropertyType)))
				{
					if (TempData["ddlPropertyType"] != null && TempData["ddlPropertyType"].ToString() == propertyType.ToString())
					{
						<option value="@propertyType" selected="selected">@propertyType</option>
					}
					else
					{
						<option value="@propertyType">@propertyType</option>
					}
				}
			</select>
			<span>Year Constructed</span>
			<input name="txtYearConstructed" type="text" placeholder="Enter Year Constructed" value="@TempData["txtYearConstructed"]">
			<span>Garage Type</span>
			<select name="ddlGarageType">
				@foreach (GarageType garageType in Enum.GetValues(typeof(GarageType)))
				{
					if (TempData["ddlGarageType"] != null && TempData["ddlGarageType"].ToString() == garageType.ToString())
					{
						<option value="@garageType" selected="selected">@garageType</option>
					}
					else
					{
						<option value="@garageType">@garageType</option>
					}
				}
			</select>
			<span>Home Description</span>
			<textarea name="txtHomeDescription" rows="4" cols="20" placeholder="Home Description">@TempData["txtHomeDescription"]</textarea>
			<span>SaleStatus</span>
			<select name="ddlSaleStatus">
				@foreach (SaleStatus saleStatus in Enum.GetValues(typeof(SaleStatus)))
				{
					if (TempData["ddlSaleStatus"] != null && TempData["ddlSaleStatus"].ToString() == saleStatus.ToString())
					{
						<option value="@saleStatus" selected="selected">@saleStatus</option>
					}
					else
					{
						<option value="@saleStatus">@saleStatus</option>
					}
				}
			</select>
		</div>

		<div>
			<h2>Add Temperature Control Information</h2>
			<span>Cooling</span>
			<select name="ddlCooling">
				@foreach (CoolingTypes coolingType in Enum.GetValues(typeof(CoolingTypes)))
				{
					if (TempData["ddlCooling"] != null && TempData["ddlCooling"].ToString() == coolingType.ToString())
					{
						<option value="@coolingType" selected="selected">@coolingType</option>
					}
					else
					{
						<option value="@coolingType">@coolingType</option>
					}
				}
			</select>
			<span>Heating</span>
			<select name="ddlHeating">
				@foreach (HeatingTypes heatingType in Enum.GetValues(typeof(HeatingTypes)))
				{
					if (TempData["ddlHeating"] != null && TempData["ddlHeating"].ToString() == heatingType.ToString())
					{
						<option value="@heatingType" selected="selected">@heatingType</option>
					}
					else
					{
						<option value="@heatingType">@heatingType</option>
					}
				}
			</select>
		</div>

		<div>
			<h2>Home Room Information</h2>
			<table class="table table-hover">
				<thead>
					<tr>
						<td>Length</td>
						<td>Width</td>
						<td>RoomType</td>
					</tr>
				</thead>
				<tbody>
					@if (currentRooms.List.Count == 0)
					{
						<tr>
							<td>No Room Data</td>
						</tr>
					}
					else
					{
						@for (int i = 0; i < currentRooms.List.Count; i++)
						{
							<tr>
								<td>@currentRooms.List[i].Height</td>
								<td>@currentRooms.List[i].Width</td>
								<td>@currentRooms.List[i].Type</td>
								<td><button type="submit" formaction="/RealEstateHome/RemoveEditRoom/@i" formmethod="POST" class="btn btn-danger">Remove Room</button></td>
							</tr>
						}
					}

				</tbody>
			</table>

			<h3>Add New Room</h3>
			<div>
				<span>Length: </span>
				<input name="roomLength" type="text" placeholder="Enter Length">
				<span>Width: </span>
				<input name="roomWidth" type="text" placeholder="Enter Width">
				<span>RoomType: </span>
				<select name="roomType">
					@foreach (RoomType roomType in Enum.GetValues(typeof(RoomType)))
					{

						<option value="@roomType">@roomType</option>

					}
				</select>
				<button type="submit" formaction="/RealEstateHome/AddEditRoom" formmethod="POST" class="btn btn-primary">Add Room</button>
			</div>
		</div>

		<div>
			<h2>Home Image Information</h2>
			<table class="table table-hover">
				<thead>
					<tr>
						<td>Image Type</td>
						<td>Image Description</td>
						<td>Is Main Image</td>
					</tr>
				</thead>
				<tbody>
					@if (currentImages.List.Count == 0)
					{
						<tr>
							<td>No Image Data</td>
						</tr>
					}
					else
					{
						@for (int i = 0; i < currentImages.List.Count; i++)
						{
							<tr>
								<td>@currentImages.List[i].Type</td>
								<td>@currentImages.List[i].Description</td>
								<td>@currentImages.List[i].MainImage</td>
								<td><button type="submit" formaction="/RealEstateHome/RemoveEditImage/@i" formmethod="POST" class="btn btn-danger">Remove Image</button></td>
							</tr>
						}
					}

				</tbody>
			</table>
			<h3>Add New Image</h3>
			<div>
				<span>Image Description: </span>
				<input name="imageDescription" type="text" placeholder="Enter Image Description">
				<span>Image Type: </span>
				<select name="imageType">
					@foreach (RoomType roomType in Enum.GetValues(typeof(RoomType)))
					{
						<option value="@roomType">@roomType</option>
					}
				</select>
				<span>Upload Image</span>
				<input type="file" name="imageFile">
				<label class="form-label">Default Image</label>
				<div class="form-check">
					<input type="radio" id="yes" name="defaultImage" value="true" class="form-check-input" />
					<label for="yes" class="form-check-label">Yes</label>
				</div>
				<div class="form-check">
					<input type="radio" id="no" name="defaultImage" value="false" class="form-check-input" />
					<label for="no" class="form-check-label">No</label>
				</div>
				<button type="submit" formaction="/RealEstateHome/AddEditImage" formmethod="POST" class="btn btn-primary">Add Room</button>
			</div>
		</div>

		<button type="submit" name="save">Save Edit</button>
		<a asp-controller="RealEstateHome" asp-action="AllEditHomes" class="btn btn-secondary w-100">Cancel Edit</a>
	</form>
</body>
</html>
